{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.232.2"},"children":{"RearcPipelineStack":{"id":"RearcPipelineStack","path":"RearcPipelineStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.232.2"},"children":{"RearcDataBucket":{"id":"RearcDataBucket","path":"RearcPipelineStack/RearcDataBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.232.2","metadata":[]},"children":{"Resource":{"id":"Resource","path":"RearcPipelineStack/RearcDataBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.232.2"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"versioningConfiguration":{"status":"Enabled"}}}},"Notifications":{"id":"Notifications","path":"RearcPipelineStack/RearcDataBucket/Notifications","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"},"children":{"Resource":{"id":"Resource","path":"RearcPipelineStack/RearcDataBucket/Notifications/Resource","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.232.2"}}}}}},"RearcQueue":{"id":"RearcQueue","path":"RearcPipelineStack/RearcQueue","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.Queue","version":"2.232.2","metadata":[]},"children":{"Resource":{"id":"Resource","path":"RearcPipelineStack/RearcQueue/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueue","version":"2.232.2"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::Queue","aws:cdk:cloudformation:props":{"visibilityTimeout":600}}},"Policy":{"id":"Policy","path":"RearcPipelineStack/RearcQueue/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.QueuePolicy","version":"2.232.2","metadata":[]},"children":{"Resource":{"id":"Resource","path":"RearcPipelineStack/RearcQueue/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sqs.CfnQueuePolicy","version":"2.232.2"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SQS::QueuePolicy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["sqs:SendMessage","sqs:GetQueueAttributes","sqs:GetQueueUrl"],"Condition":{"ArnLike":{"aws:SourceArn":{"Fn::GetAtt":["RearcDataBucket2BD2D5E5","Arn"]}}},"Effect":"Allow","Principal":{"Service":"s3.amazonaws.com"},"Resource":{"Fn::GetAtt":["RearcQueue4197B2EF","Arn"]}}],"Version":"2012-10-17"},"queues":[{"Ref":"RearcQueue4197B2EF"}]}}}}}}},"DepsLayer":{"id":"DepsLayer","path":"RearcPipelineStack/DepsLayer","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.LayerVersion","version":"2.232.2","metadata":[]},"children":{"Code":{"id":"Code","path":"RearcPipelineStack/DepsLayer/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.232.2"},"children":{"Stage":{"id":"Stage","path":"RearcPipelineStack/DepsLayer/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.232.2"}},"AssetBucket":{"id":"AssetBucket","path":"RearcPipelineStack/DepsLayer/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.232.2","metadata":[]}}}},"Resource":{"id":"Resource","path":"RearcPipelineStack/DepsLayer/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnLayerVersion","version":"2.232.2"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::LayerVersion","aws:cdk:cloudformation:props":{"compatibleRuntimes":["python3.11"],"content":{"s3Bucket":{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"},"s3Key":"1e59a61d060c6814bf828685d575eafb0fc7c4fbb7ba1dc0489166f2801090e0.zip"},"description":"requests, pandas, bs4"}}}}},"IngestLambda":{"id":"IngestLambda","path":"RearcPipelineStack/IngestLambda","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.232.2","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"RearcPipelineStack/IngestLambda/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.232.2","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"RearcPipelineStack/IngestLambda/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.232.2","metadata":[]}},"Resource":{"id":"Resource","path":"RearcPipelineStack/IngestLambda/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.232.2"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"RearcPipelineStack/IngestLambda/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.232.2","metadata":[]},"children":{"Resource":{"id":"Resource","path":"RearcPipelineStack/IngestLambda/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.232.2"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["RearcDataBucket2BD2D5E5","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["RearcDataBucket2BD2D5E5","Arn"]},"/*"]]}]}],"Version":"2012-10-17"},"policyName":"IngestLambdaServiceRoleDefaultPolicyA78EFF9F","roles":[{"Ref":"IngestLambdaServiceRole18CD342B"}]}}}}}}},"Code":{"id":"Code","path":"RearcPipelineStack/IngestLambda/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.232.2"},"children":{"Stage":{"id":"Stage","path":"RearcPipelineStack/IngestLambda/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.232.2"}},"AssetBucket":{"id":"AssetBucket","path":"RearcPipelineStack/IngestLambda/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.232.2","metadata":[]}}}},"Resource":{"id":"Resource","path":"RearcPipelineStack/IngestLambda/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.232.2"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"},"s3Key":"e8d32125ea345a99c3662b3f8b1d2a6e71995a16f56d154fb88f9004893a1c29.zip"},"environment":{"variables":{"BUCKET":{"Ref":"RearcDataBucket2BD2D5E5"},"POP_PREFIX":"raw/datausa/population/","BLS_PREFIX":"bls-folder/"}},"handler":"ingest_lambda.handler","layers":[{"Ref":"DepsLayerA0D7F79A"}],"role":{"Fn::GetAtt":["IngestLambdaServiceRole18CD342B","Arn"]},"runtime":"python3.11","timeout":600}}}}},"DailyIngestSchedule":{"id":"DailyIngestSchedule","path":"RearcPipelineStack/DailyIngestSchedule","constructInfo":{"fqn":"aws-cdk-lib.aws_events.Rule","version":"2.232.2","metadata":[]},"children":{"Resource":{"id":"Resource","path":"RearcPipelineStack/DailyIngestSchedule/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"2.232.2"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"scheduleExpression":"rate(1 day)","state":"ENABLED","targets":[{"id":"Target0","arn":{"Fn::GetAtt":["IngestLambda9890CC8D","Arn"]}}]}}},"AllowEventRuleRearcPipelineStackIngestLambda494559AD":{"id":"AllowEventRuleRearcPipelineStackIngestLambda494559AD","path":"RearcPipelineStack/DailyIngestSchedule/AllowEventRuleRearcPipelineStackIngestLambda494559AD","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.232.2"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["IngestLambda9890CC8D","Arn"]},"principal":"events.amazonaws.com","sourceArn":{"Fn::GetAtt":["DailyIngestSchedule3C10BBE8","Arn"]}}}}}},"BucketNotificationsHandler050a0587b7544547bf325f094a3db834":{"id":"BucketNotificationsHandler050a0587b7544547bf325f094a3db834","path":"RearcPipelineStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"},"children":{"Role":{"id":"Role","path":"RearcPipelineStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.232.2","metadata":[]},"children":{"ImportRole":{"id":"ImportRole","path":"RearcPipelineStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/ImportRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.232.2","metadata":[]}},"Resource":{"id":"Resource","path":"RearcPipelineStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.232.2"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"RearcPipelineStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.232.2","metadata":[]},"children":{"Resource":{"id":"Resource","path":"RearcPipelineStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Role/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.232.2"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"s3:PutBucketNotification","Effect":"Allow","Resource":{"Fn::GetAtt":["RearcDataBucket2BD2D5E5","Arn"]}}],"Version":"2012-10-17"},"policyName":"BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleDefaultPolicy2CF63D36","roles":[{"Ref":"BucketNotificationsHandler050a0587b7544547bf325f094a3db834RoleB6FB88EC"}]}}}}}}},"Resource":{"id":"Resource","path":"RearcPipelineStack/BucketNotificationsHandler050a0587b7544547bf325f094a3db834/Resource","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.232.2"}}}},"AnalyticsLambda":{"id":"AnalyticsLambda","path":"RearcPipelineStack/AnalyticsLambda","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.232.2","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"RearcPipelineStack/AnalyticsLambda/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.232.2","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"RearcPipelineStack/AnalyticsLambda/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.232.2","metadata":[]}},"Resource":{"id":"Resource","path":"RearcPipelineStack/AnalyticsLambda/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.232.2"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"RearcPipelineStack/AnalyticsLambda/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.232.2","metadata":[]},"children":{"Resource":{"id":"Resource","path":"RearcPipelineStack/AnalyticsLambda/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.232.2"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["RearcDataBucket2BD2D5E5","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["RearcDataBucket2BD2D5E5","Arn"]},"/*"]]}]},{"Action":["sqs:ReceiveMessage","sqs:ChangeMessageVisibility","sqs:GetQueueUrl","sqs:DeleteMessage","sqs:GetQueueAttributes"],"Effect":"Allow","Resource":{"Fn::GetAtt":["RearcQueue4197B2EF","Arn"]}}],"Version":"2012-10-17"},"policyName":"AnalyticsLambdaServiceRoleDefaultPolicy17E4F380","roles":[{"Ref":"AnalyticsLambdaServiceRole5BA14A8F"}]}}}}}}},"Code":{"id":"Code","path":"RearcPipelineStack/AnalyticsLambda/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.232.2"},"children":{"Stage":{"id":"Stage","path":"RearcPipelineStack/AnalyticsLambda/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.232.2"}},"AssetBucket":{"id":"AssetBucket","path":"RearcPipelineStack/AnalyticsLambda/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.232.2","metadata":[]}}}},"Resource":{"id":"Resource","path":"RearcPipelineStack/AnalyticsLambda/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.232.2"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"},"s3Key":"e8d32125ea345a99c3662b3f8b1d2a6e71995a16f56d154fb88f9004893a1c29.zip"},"environment":{"variables":{"BUCKET":{"Ref":"RearcDataBucket2BD2D5E5"},"POP_PREFIX":"raw/datausa/population/","BLS_KEY":"bls-folder/pr/pr.data.0.Current"}},"handler":"analytics_lambda.handler","layers":[{"Ref":"DepsLayerA0D7F79A"}],"role":{"Fn::GetAtt":["AnalyticsLambdaServiceRole5BA14A8F","Arn"]},"runtime":"python3.11","timeout":600}}},"SqsEventSource:RearcPipelineStackRearcQueue08ACEE3B":{"id":"SqsEventSource:RearcPipelineStackRearcQueue08ACEE3B","path":"RearcPipelineStack/AnalyticsLambda/SqsEventSource:RearcPipelineStackRearcQueue08ACEE3B","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.EventSourceMapping","version":"2.232.2","metadata":[]},"children":{"Resource":{"id":"Resource","path":"RearcPipelineStack/AnalyticsLambda/SqsEventSource:RearcPipelineStackRearcQueue08ACEE3B/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnEventSourceMapping","version":"2.232.2"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::EventSourceMapping","aws:cdk:cloudformation:props":{"batchSize":1,"eventSourceArn":{"Fn::GetAtt":["RearcQueue4197B2EF","Arn"]},"functionName":{"Ref":"AnalyticsLambda406A5DA6"}}}}}}}},"CDKMetadata":{"id":"CDKMetadata","path":"RearcPipelineStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"},"children":{"Default":{"id":"Default","path":"RearcPipelineStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.232.2"}},"Condition":{"id":"Condition","path":"RearcPipelineStack/CDKMetadata/Condition","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.232.2"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"RearcPipelineStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.232.2"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"RearcPipelineStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.232.2"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"}}}}}